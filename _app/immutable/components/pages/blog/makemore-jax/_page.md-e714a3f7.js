import{S as fo,i as ho,s as mo,k as l,l as c,m as u,h as a,n as v,b as o,F as t,B as va,Q as bo,T as _o,q as k,a as m,r as f,c as b,E as io,G as vo,u as yo,w as bn,P as wo,x as dn,y as _n,f as vn,t as yn,z as wn,J as Os}from"../../../../chunks/index-bb3ebf24.js";const Eo=""+new URL("../../../../assets/torch_loss-df06d0fc.png",import.meta.url).href,go=""+new URL("../../../../assets/jax_loss-49ad9ea1.png",import.meta.url).href,Io=""+new URL("../../../../assets/torch_emb-8d851cc5.png",import.meta.url).href,To=""+new URL("../../../../assets/jax_emb-ae929fac.png",import.meta.url).href;function uo(h,s,r){const p=h.slice();return p[4]=s[r],p}function ro(h){let s,r,p=h[4]+"",i,d,w,_;function E(){return h[3](h[4])}return{c(){s=l("li"),r=l("div"),i=k(p),d=m(),this.h()},l(P){s=c(P,"LI",{class:!0});var g=u(s);r=c(g,"DIV",{class:!0});var I=u(r);i=f(I,p),I.forEach(a),d=b(g),g.forEach(a),this.h()},h(){v(r,"class","svelte-s2w0x0"),io(r,"active",h[4]===h[1]),v(s,"class","svelte-s2w0x0")},m(P,g){o(P,s,g),t(s,r),t(r,i),t(s,d),w||(_=vo(s,"click",E),w=!0)},p(P,g){h=P,g&1&&p!==(p=h[4]+"")&&yo(i,p),g&3&&io(r,"active",h[4]===h[1])},d(P){P&&a(s),w=!1,_()}}}function Po(h){let s,r,p=h[0],i=[];for(let d=0;d<p.length;d+=1)i[d]=ro(uo(h,p,d));return{c(){s=l("div"),r=l("ul");for(let d=0;d<i.length;d+=1)i[d].c();this.h()},l(d){s=c(d,"DIV",{class:!0});var w=u(s);r=c(w,"UL",{class:!0});var _=u(r);for(let E=0;E<i.length;E+=1)i[E].l(_);_.forEach(a),w.forEach(a),this.h()},h(){v(r,"class","svelte-s2w0x0"),v(s,"class","tabs")},m(d,w){o(d,s,w),t(s,r);for(let _=0;_<i.length;_+=1)i[_].m(r,null)},p(d,[w]){if(w&7){p=d[0];let _;for(_=0;_<p.length;_+=1){const E=uo(d,p,_);i[_]?i[_].p(E,w):(i[_]=ro(E),i[_].c(),i[_].m(r,null))}for(;_<i.length;_+=1)i[_].d(1);i.length=p.length}},i:va,o:va,d(d){d&&a(s),bo(i,d)}}}function Ao(h,s,r){const p=_o();let{tabItems:i}=s,{activeItem:d}=s;const w=_=>p("tabChange",_);return h.$$set=_=>{"tabItems"in _&&r(0,i=_.tabItems),"activeItem"in _&&r(1,d=_.activeItem)},[i,d,p,w]}class En extends fo{constructor(s){super(),ho(this,s,Ao,Po,mo,{tabItems:0,activeItem:1})}}function $o(h){let s,r=`<code class="language-python">alphabet_size <span class="token operator">=</span> <span class="token number">27</span>
context_size <span class="token operator">=</span> <span class="token number">3</span>
neurons <span class="token operator">=</span> <span class="token number">100</span>
d <span class="token operator">=</span> <span class="token number">2</span>

key <span class="token operator">=</span> jrandom<span class="token punctuation">.</span>PRNGKey<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
key<span class="token punctuation">,</span> <span class="token operator">*</span>subkeys <span class="token operator">=</span> jrandom<span class="token punctuation">.</span>split<span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>
subkeys <span class="token operator">=</span> <span class="token builtin">iter</span><span class="token punctuation">(</span>subkeys<span class="token punctuation">)</span>

C <span class="token operator">=</span> jrandom<span class="token punctuation">.</span>normal<span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>subkeys<span class="token punctuation">)</span><span class="token punctuation">,</span> shape<span class="token operator">=</span><span class="token punctuation">(</span>alphabet_size<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">)</span>
W1 <span class="token operator">=</span> jrandom<span class="token punctuation">.</span>normal<span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>subkeys<span class="token punctuation">)</span><span class="token punctuation">,</span> shape<span class="token operator">=</span><span class="token punctuation">(</span>d <span class="token operator">*</span> context_size<span class="token punctuation">,</span> neurons<span class="token punctuation">)</span><span class="token punctuation">)</span>
b1 <span class="token operator">=</span> jrandom<span class="token punctuation">.</span>normal<span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>subkeys<span class="token punctuation">)</span><span class="token punctuation">,</span> shape<span class="token operator">=</span><span class="token punctuation">(</span>neurons<span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>
W2 <span class="token operator">=</span> jrandom<span class="token punctuation">.</span>normal<span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>subkeys<span class="token punctuation">)</span><span class="token punctuation">,</span> shape<span class="token operator">=</span><span class="token punctuation">(</span>neurons<span class="token punctuation">,</span> alphabet_size<span class="token punctuation">)</span><span class="token punctuation">)</span>
b2 <span class="token operator">=</span> jrandom<span class="token punctuation">.</span>normal<span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>subkeys<span class="token punctuation">)</span><span class="token punctuation">,</span> shape<span class="token operator">=</span><span class="token punctuation">(</span>alphabet_size<span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>

parameters <span class="token operator">=</span> <span class="token punctuation">[</span>C<span class="token punctuation">,</span> W1<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> W2<span class="token punctuation">,</span> b2<span class="token punctuation">]</span></code>`;return{c(){s=l("pre"),this.h()},l(p){s=c(p,"PRE",{class:!0});var i=u(s);i.forEach(a),this.h()},h(){v(s,"class","language-python")},m(p,i){o(p,s,i),s.innerHTML=r},d(p){p&&a(s)}}}function Xo(h){let s,r=`<code class="language-python">alphabet_size <span class="token operator">=</span> <span class="token number">27</span>
context_size <span class="token operator">=</span> <span class="token number">3</span>
neurons <span class="token operator">=</span> <span class="token number">100</span>
d <span class="token operator">=</span> <span class="token number">2</span>

g <span class="token operator">=</span> torch<span class="token punctuation">.</span>Generator<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>manual_seed<span class="token punctuation">(</span><span class="token number">2147483647</span><span class="token punctuation">)</span>

C <span class="token operator">=</span>  torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>generator<span class="token operator">=</span>g<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token punctuation">(</span>alphabet_size<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">)</span>
W1 <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>generator<span class="token operator">=</span>g<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token punctuation">(</span>d <span class="token operator">*</span> context_size<span class="token punctuation">,</span> neurons<span class="token punctuation">)</span><span class="token punctuation">)</span>
b1 <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>generator<span class="token operator">=</span>g<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token punctuation">(</span>neurons<span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>
W2 <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>generator<span class="token operator">=</span>g<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token punctuation">(</span>neurons<span class="token punctuation">,</span> alphabet_size<span class="token punctuation">)</span><span class="token punctuation">)</span>
b2 <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>generator<span class="token operator">=</span>g<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token punctuation">(</span>alphabet_size<span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>

parameters <span class="token operator">=</span> <span class="token punctuation">[</span>C<span class="token punctuation">,</span> W1<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> W2<span class="token punctuation">,</span> b2<span class="token punctuation">]</span></code>`;return{c(){s=l("pre"),this.h()},l(p){s=c(p,"PRE",{class:!0});var i=u(s);i.forEach(a),this.h()},h(){v(s,"class","language-python")},m(p,i){o(p,s,i),s.innerHTML=r},d(p){p&&a(s)}}}function Jo(h){let s,r=`<code class="language-python"><span class="token keyword">def</span> <span class="token function">model</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span> W1<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> W2<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">:</span>
    emb <span class="token operator">=</span> C<span class="token punctuation">[</span>X<span class="token punctuation">]</span>
    h <span class="token operator">=</span> jnp<span class="token punctuation">.</span>tanh<span class="token punctuation">(</span>emb<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span> @ W1 <span class="token operator">+</span> b1<span class="token punctuation">)</span>
    logits <span class="token operator">=</span> h @ W2 <span class="token operator">+</span> b2
    logits <span class="token operator">-=</span> logits<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    counts <span class="token operator">=</span> jnp<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>logits<span class="token punctuation">)</span>
    probs <span class="token operator">=</span> counts <span class="token operator">/</span> counts<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> probs</code>`;return{c(){s=l("pre"),this.h()},l(p){s=c(p,"PRE",{class:!0});var i=u(s);i.forEach(a),this.h()},h(){v(s,"class","language-python")},m(p,i){o(p,s,i),s.innerHTML=r},d(p){p&&a(s)}}}function Lo(h){let s,r=`<code class="language-python"><span class="token keyword">def</span> <span class="token function">model</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span> W1<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> W2<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">:</span>
    emb <span class="token operator">=</span> C<span class="token punctuation">[</span>X<span class="token punctuation">]</span>
    h <span class="token operator">=</span> torch<span class="token punctuation">.</span>tanh<span class="token punctuation">(</span>emb<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span> @ W1 <span class="token operator">+</span> b1<span class="token punctuation">)</span>
    logits <span class="token operator">=</span> h @ W2 <span class="token operator">+</span> b2
    logits <span class="token operator">-=</span> logits<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values
    counts <span class="token operator">=</span> torch<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>logits<span class="token punctuation">)</span>
    probs <span class="token operator">=</span> counts <span class="token operator">/</span> counts<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> probs</code>`;return{c(){s=l("pre"),this.h()},l(p){s=c(p,"PRE",{class:!0});var i=u(s);i.forEach(a),this.h()},h(){v(s,"class","language-python")},m(p,i){o(p,s,i),s.innerHTML=r},d(p){p&&a(s)}}}function Wo(h){let s,r=`<code class="language-python"><span class="token keyword">def</span> <span class="token function">loss_fn</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span> W1<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> W2<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    probs <span class="token operator">=</span> model<span class="token punctuation">(</span>C<span class="token punctuation">,</span> W1<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> W2<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> X<span class="token punctuation">)</span>
    loss <span class="token operator">=</span> <span class="token operator">-</span>jnp<span class="token punctuation">.</span>log<span class="token punctuation">(</span>probs<span class="token punctuation">[</span>jnp<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Y<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> loss</code>`;return{c(){s=l("pre"),this.h()},l(p){s=c(p,"PRE",{class:!0});var i=u(s);i.forEach(a),this.h()},h(){v(s,"class","language-python")},m(p,i){o(p,s,i),s.innerHTML=r},d(p){p&&a(s)}}}function Co(h){let s,r=`<code class="language-python"><span class="token keyword">def</span> <span class="token function">loss_fn</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span> W1<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> W2<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    probs <span class="token operator">=</span> model<span class="token punctuation">(</span>C<span class="token punctuation">,</span> W1<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> W2<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> X<span class="token punctuation">)</span>
    loss <span class="token operator">=</span> <span class="token operator">-</span>torch<span class="token punctuation">.</span>log<span class="token punctuation">(</span>probs<span class="token punctuation">[</span>torch<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Y<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> loss</code>`;return{c(){s=l("pre"),this.h()},l(p){s=c(p,"PRE",{class:!0});var i=u(s);i.forEach(a),this.h()},h(){v(s,"class","language-python")},m(p,i){o(p,s,i),s.innerHTML=r},d(p){p&&a(s)}}}function jo(h){let s,r=`<code class="language-python"><span class="token keyword">def</span> <span class="token function">train</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span> W1<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> W2<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> Xb<span class="token punctuation">,</span> Yb<span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    grad_fn <span class="token operator">=</span> grad<span class="token punctuation">(</span>loss_fn<span class="token punctuation">,</span> argnums<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    gC<span class="token punctuation">,</span> gW1<span class="token punctuation">,</span> gb1<span class="token punctuation">,</span> gW2<span class="token punctuation">,</span> gb2 <span class="token operator">=</span> grad_fn<span class="token punctuation">(</span>C<span class="token punctuation">,</span> W1<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> W2<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> Xb<span class="token punctuation">,</span> Yb<span class="token punctuation">)</span>

    C <span class="token operator">-=</span> lr <span class="token operator">*</span> gC
    W1 <span class="token operator">-=</span> lr <span class="token operator">*</span> gW1
    b1 <span class="token operator">-=</span> lr <span class="token operator">*</span> gb1
    W2 <span class="token operator">-=</span> lr <span class="token operator">*</span> gW2
    b2 <span class="token operator">-=</span> lr <span class="token operator">*</span> gb2

    <span class="token keyword">return</span> C<span class="token punctuation">,</span> W1<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> W2<span class="token punctuation">,</span> b2</code>`;return{c(){s=l("pre"),this.h()},l(p){s=c(p,"PRE",{class:!0});var i=u(s);i.forEach(a),this.h()},h(){v(s,"class","language-python")},m(p,i){o(p,s,i),s.innerHTML=r},d(p){p&&a(s)}}}function Ho(h){let s,r=`<code class="language-python"><span class="token keyword">def</span> <span class="token function">train</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span> W1<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> W2<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> Xb<span class="token punctuation">,</span> Yb<span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    loss <span class="token operator">=</span> loss_fn<span class="token punctuation">(</span>C<span class="token punctuation">,</span> W1<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> W2<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> Xb<span class="token punctuation">,</span> Yb<span class="token punctuation">)</span>

    <span class="token keyword">for</span> p <span class="token keyword">in</span> parameters<span class="token punctuation">:</span>
        p<span class="token punctuation">.</span>grad <span class="token operator">=</span> <span class="token boolean">None</span>

    loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> p <span class="token keyword">in</span> parameters<span class="token punctuation">:</span>
        p<span class="token punctuation">.</span>data <span class="token operator">-=</span> lr <span class="token operator">*</span> p<span class="token punctuation">.</span>grad</code>`;return{c(){s=l("pre"),this.h()},l(p){s=c(p,"PRE",{class:!0});var i=u(s);i.forEach(a),this.h()},h(){v(s,"class","language-python")},m(p,i){o(p,s,i),s.innerHTML=r},d(p){p&&a(s)}}}function Mo(h){let s,r=`<code class="language-python">key <span class="token operator">=</span> jrandom<span class="token punctuation">.</span>PRNGKey<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    key<span class="token punctuation">,</span> subkey <span class="token operator">=</span> jrandom<span class="token punctuation">.</span>split<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
    ix <span class="token operator">=</span> jrandom<span class="token punctuation">.</span>randint<span class="token punctuation">(</span>subkey<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span> minval<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> maxval<span class="token operator">=</span>Xtr<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    Xb<span class="token punctuation">,</span> Yb <span class="token operator">=</span> Xtr<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">,</span> Ytr<span class="token punctuation">[</span>ix<span class="token punctuation">]</span>
    C<span class="token punctuation">,</span> W1<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> W2<span class="token punctuation">,</span> b2 <span class="token operator">=</span> train<span class="token punctuation">(</span>C<span class="token punctuation">,</span> W1<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> W2<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> Xb<span class="token punctuation">,</span> Yb<span class="token punctuation">)</span></code>`;return{c(){s=l("pre"),this.h()},l(p){s=c(p,"PRE",{class:!0});var i=u(s);i.forEach(a),this.h()},h(){v(s,"class","language-python")},m(p,i){o(p,s,i),s.innerHTML=r},d(p){p&&a(s)}}}function zo(h){let s,r=`<code class="language-python">g <span class="token operator">=</span> torch<span class="token punctuation">.</span>Generator<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>manual_seed<span class="token punctuation">(</span><span class="token number">2147483647</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    ix <span class="token operator">=</span> torch<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> Xtr<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span> generator<span class="token operator">=</span>g<span class="token punctuation">)</span>
    Xb<span class="token punctuation">,</span> Yb <span class="token operator">=</span> Xtr<span class="token punctuation">[</span>ix<span class="token punctuation">]</span><span class="token punctuation">,</span> Ytr<span class="token punctuation">[</span>ix<span class="token punctuation">]</span>
    train<span class="token punctuation">(</span>C<span class="token punctuation">,</span> W1<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> W2<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> Xb<span class="token punctuation">,</span> Yb<span class="token punctuation">)</span></code>`;return{c(){s=l("pre"),this.h()},l(p){s=c(p,"PRE",{class:!0});var i=u(s);i.forEach(a),this.h()},h(){v(s,"class","language-python")},m(p,i){o(p,s,i),s.innerHTML=r},d(p){p&&a(s)}}}function No(h){let s,r,p;return{c(){s=l("p"),r=l("img"),this.h()},l(i){s=c(i,"P",{});var d=u(s);r=c(d,"IMG",{src:!0,alt:!0}),d.forEach(a),this.h()},h(){Os(r.src,p=go)||v(r,"src",p),v(r,"alt","jax-loss")},m(i,d){o(i,s,d),t(s,r)},p:va,d(i){i&&a(s)}}}function Ro(h){let s,r,p;return{c(){s=l("p"),r=l("img"),this.h()},l(i){s=c(i,"P",{});var d=u(s);r=c(d,"IMG",{src:!0,alt:!0}),d.forEach(a),this.h()},h(){Os(r.src,p=Eo)||v(r,"src",p),v(r,"alt","torch-loss")},m(i,d){o(i,s,d),t(s,r)},p:va,d(i){i&&a(s)}}}function Yo(h){let s,r,p;return{c(){s=l("p"),r=l("img"),this.h()},l(i){s=c(i,"P",{});var d=u(s);r=c(d,"IMG",{src:!0,alt:!0}),d.forEach(a),this.h()},h(){Os(r.src,p=To)||v(r,"src",p),v(r,"alt","jax-emb")},m(i,d){o(i,s,d),t(s,r)},p:va,d(i){i&&a(s)}}}function Do(h){let s,r,p;return{c(){s=l("p"),r=l("img"),this.h()},l(i){s=c(i,"P",{});var d=u(s);r=c(d,"IMG",{src:!0,alt:!0}),d.forEach(a),this.h()},h(){Os(r.src,p=Io)||v(r,"src",p),v(r,"alt","torch-emb")},m(i,d){o(i,s,d),t(s,r)},p:va,d(i){i&&a(s)}}}function Go(h){let s,r,p,i,d,w,_,E,P,g,I,D,N,$,G,R,T,B;return{c(){s=l("ul"),r=l("li"),p=k("brone"),i=m(),d=l("li"),w=k("jieai"),_=m(),E=l("li"),P=k("krillo"),g=m(),I=l("li"),D=k("jrayle"),N=m(),$=l("li"),G=k("karireio"),R=m(),T=l("li"),B=k("addelie")},l(A){s=c(A,"UL",{});var y=u(s);r=c(y,"LI",{});var q=u(r);p=f(q,"brone"),q.forEach(a),i=b(y),d=c(y,"LI",{});var U=u(d);w=f(U,"jieai"),U.forEach(a),_=b(y),E=c(y,"LI",{});var Y=u(E);P=f(Y,"krillo"),Y.forEach(a),g=b(y),I=c(y,"LI",{});var F=u(I);D=f(F,"jrayle"),F.forEach(a),N=b(y),$=c(y,"LI",{});var O=u($);G=f(O,"karireio"),O.forEach(a),R=b(y),T=c(y,"LI",{});var L=u(T);B=f(L,"addelie"),L.forEach(a),y.forEach(a)},m(A,y){o(A,s,y),t(s,r),t(r,p),t(s,i),t(s,d),t(d,w),t(s,_),t(s,E),t(E,P),t(s,g),t(s,I),t(I,D),t(s,N),t(s,$),t($,G),t(s,R),t(s,T),t(T,B)},d(A){A&&a(s)}}}function Bo(h){let s,r,p,i,d,w,_,E,P,g,I,D,N,$,G,R,T,B;return{c(){s=l("ul"),r=l("li"),p=k("junide"),i=m(),d=l("li"),w=k("janasad"),_=m(),E=l("li"),P=k("presay"),g=m(),I=l("li"),D=k("adin"),N=m(),$=l("li"),G=k("koi"),R=m(),T=l("li"),B=k("ritolia")},l(A){s=c(A,"UL",{});var y=u(s);r=c(y,"LI",{});var q=u(r);p=f(q,"junide"),q.forEach(a),i=b(y),d=c(y,"LI",{});var U=u(d);w=f(U,"janasad"),U.forEach(a),_=b(y),E=c(y,"LI",{});var Y=u(E);P=f(Y,"presay"),Y.forEach(a),g=b(y),I=c(y,"LI",{});var F=u(I);D=f(F,"adin"),F.forEach(a),N=b(y),$=c(y,"LI",{});var O=u($);G=f(O,"koi"),O.forEach(a),R=b(y),T=c(y,"LI",{});var L=u(T);B=f(L,"ritolia"),L.forEach(a),y.forEach(a)},m(A,y){o(A,s,y),t(s,r),t(r,p),t(s,i),t(s,d),t(d,w),t(s,_),t(s,E),t(E,P),t(s,g),t(s,I),t(I,D),t(s,N),t(s,$),t($,G),t(s,R),t(s,T),t(T,B)},d(A){A&&a(s)}}}function Uo(h){let s,r,p,i,d,w,_,E,P,g,I,D,N,$,G,R,T,B,A,y,q,U,Y,F,O,L,Ks,gn,qs,Fs,Oa,Wn,Ss,Ka,on,Vs,In,Zs,Qs,qa,Cn,xs,Fa,jn,nt,Sa,Hn,at,Va,Mn,st,Za,S,Qa,zn,pn,tt,Tn,et,ot,xa,Nn,pt,ns,V,as,Rn,Yn,lt,ss,Dn,ct,ts,Z,es,Gn,K,it,ya,ut,rt,wa,kt,ft,os,Bn,ht,ps,Q,ls,Un,ln,mt,Ea,bt,dt,cs,cn,_t,ga,vt,yt,is,un,wt,Pn,Et,gt,us,On,It,rs,x,ks,Kn,qn,Tt,fs,Fn,Pt,hs,rn,At,An,$t,Xt,ms,Sn,Jt,bs,Vn,Lt,ds,nn,_s,Zn,Qn,Wt,vs,an,ys,xn,na,Ct,ws,sn,Es,aa,sa,jt,gs,ta,Ht,Is,kn,Ia,$n,Ta,Mt,zt,Pa,Nt,Rt,Aa,Xn,$a,Yt,Dt,Xa,Gt,Ts,ea,Bt,Ps,fn,Ut,Ja,Ot,Kt,As,hn,La,tn,Wa,qt,Ft,Ca,St,Vt,ja,Zt,Qt,Ha,en,Ma,xt,ne,za,ae,se,Na,te,$s,oa,ee,Xs,pa,oe,Js,mn,pe,Jn,le,ce,Ls;S=new En({props:{tabItems:h[1],activeItem:h[0]}}),S.$on("tabChange",h[2]);function ie(n,e){if(n[0]==="Torch")return Xo;if(n[0]==="JAX")return $o}let la=ie(h),W=la&&la(h);V=new En({props:{tabItems:h[1],activeItem:h[0]}}),V.$on("tabChange",h[2]);function ue(n,e){if(n[0]==="Torch")return Lo;if(n[0]==="JAX")return Jo}let ca=ue(h),C=ca&&ca(h);Z=new En({props:{tabItems:h[1],activeItem:h[0]}}),Z.$on("tabChange",h[2]);function re(n,e){if(n[0]==="Torch")return Co;if(n[0]==="JAX")return Wo}let ia=re(h),j=ia&&ia(h);Q=new En({props:{tabItems:h[1],activeItem:h[0]}}),Q.$on("tabChange",h[2]);function ke(n,e){if(n[0]==="Torch")return Ho;if(n[0]==="JAX")return jo}let ua=ke(h),H=ua&&ua(h);x=new En({props:{tabItems:h[1],activeItem:h[0]}}),x.$on("tabChange",h[2]);function fe(n,e){if(n[0]==="Torch")return zo;if(n[0]==="JAX")return Mo}let ra=fe(h),M=ra&&ra(h);nn=new En({props:{tabItems:h[1],activeItem:h[0]}}),nn.$on("tabChange",h[2]);function he(n,e){if(n[0]==="Torch")return Ro;if(n[0]==="JAX")return No}let ka=he(h),X=ka&&ka(h);an=new En({props:{tabItems:h[1],activeItem:h[0]}}),an.$on("tabChange",h[2]);function me(n,e){if(n[0]==="Torch")return Do;if(n[0]==="JAX")return Yo}let fa=me(h),J=fa&&fa(h);sn=new En({props:{tabItems:h[1],activeItem:h[0]}}),sn.$on("tabChange",h[2]);function be(n,e){if(n[0]==="Torch")return Bo;if(n[0]==="JAX")return Go}let ha=be(h),z=ha&&ha(h);return{c(){s=l("link"),r=m(),p=l("h1"),i=k(ko),d=m(),w=l("p"),_=l("a"),E=k("JAX"),P=k(` is a cool machine learning framework from Google.
Language models (LMs) are the family of models that include ChatGPT and GPT-4, which have taken the machine learning world by storm.`),g=m(),I=l("p"),D=k("What better way to learn about both than to implement a simple LM in JAX?"),N=m(),$=l("h2"),G=k("Resources"),R=m(),T=l("p"),B=k("I’ll heavily rely on Andrej Karpathy’s amazing course "),A=l("a"),y=k("Neural Networks: Zero to Hero"),q=k(` for this implementation.
The course starts from the very basics of neural networks and slowly builds up to implementing a GPT model.`),U=m(),Y=l("p"),F=k(`If you are interested in learning about all of these things in detail, I highly recommend checking the course out.
This blog post is only concerned about porting the implementation to JAX, and won’t go into the theoretical background of what is being implemented.`),O=m(),L=l("p"),Ks=k("As for JAX, I’ve found the "),gn=l("a"),qs=k("official documentation"),Fs=k(" adequate so far."),Oa=m(),Wn=l("h2"),Ss=k("Model"),Ka=m(),on=l("p"),Vs=k("The model I’m interested in building is the Multi Layer Perceptron (MLP) model from "),In=l("a"),Zs=k("Building makemore Part 2: MLP"),Qs=k(`.
I think this is a good starting point due to the simplicity of the model built in this chapter.`),qa=m(),Cn=l("p"),xs=k("Following the steps in this video, I will be building a character-level LM that looks at the previous three characters to predict which character will come next."),Fa=m(),jn=l("h2"),nt=k("Implementation"),Sa=m(),Hn=l("p"),at=k("While displaying the relevant code blocks, I’ll also provide the PyTorch counterparts in a separate tab for easier comparison."),Va=m(),Mn=l("p"),st=k("Let’s start by initializing the model parameters:"),Za=m(),bn(S.$$.fragment),Qa=m(),W&&W.c(),zn=m(),pn=l("p"),tt=k(`You can notice they are very similar.
Other than method and parameter names, the only difference is how JAX handles random number generation.
You can read more about that in the corresponding section of `),Tn=l("a"),et=k("🔪 JAX - The Sharp Bits 🔪"),ot=k("."),xa=m(),Nn=l("p"),pt=k("Now let’s write the forward pass:"),ns=m(),bn(V.$$.fragment),as=m(),C&&C.c(),Rn=m(),Yn=l("p"),lt=k("Again very similar."),ss=m(),Dn=l("p"),ct=k("Now we need a loss function:"),ts=m(),bn(Z.$$.fragment),es=m(),j&&j.c(),Gn=m(),K=l("p"),it=k("Here literally the only change is replacing "),ya=l("code"),ut=k("torch"),rt=k(" with "),wa=l("code"),kt=k("jnp"),ft=k("."),os=m(),Bn=l("p"),ht=k("And now the training function, which is the first major difference between PyTorch and JAX:"),ps=m(),bn(Q.$$.fragment),ls=m(),H&&H.c(),Un=m(),ln=l("p"),mt=k("In PyTorch, we get a tensor from the loss function, which we can call "),Ea=l("code"),bt=k("backward"),dt=k(` on to backpropagate the gradients to our parameters.
Then, we can loop through all our parameters and update them in-place.
We also need to remember to clear up the gradients for each parameter after every iteration, otherwise they would accumulate.`),cs=m(),cn=l("p"),_t=k("In JAX, we use "),ga=l("code"),vt=k("grad"),yt=k(` on the loss function to obtain a new function that evaluates the gradients of that function with respect to the parameters we choose.
We then use that function to find the gradients at the current point in our parameter space, and use those gradients to update them.
Also notable: we need to return new arrays to replace the old ones, instead of updating them in-place as JAX follows a more functional paradigm than PyTorch.`),is=m(),un=l("p"),wt=k("Even though I passed each parameter and received their gradients explicitly in this implementation, JAX also has ways to pass all parameters and receive all gradients together using "),Pn=l("a"),Et=k("pytrees"),gt=k("."),us=m(),On=l("p"),It=k("Finally, the training loop:"),rs=m(),bn(x.$$.fragment),ks=m(),M&&M.c(),Kn=m(),qn=l("p"),Tt=k("Again we see only minimal differences due to how the two libraries handle random number generation differently."),fs=m(),Fn=l("h2"),Pt=k("Data"),hs=m(),rn=l("p"),At=k("I’ll use the same "),An=l("a"),$t=k("dataset of 32K English names"),Xt=k(" as Andrej and split it into train / dev / test sets in the same way."),ms=m(),Sn=l("h2"),Jt=k("Training & Evaluation"),bs=m(),Vn=l("p"),Lt=k("Here are the training and dev losses during training:"),ds=m(),bn(nn.$$.fragment),_s=m(),X&&X.c(),Zn=m(),Qn=l("p"),Wt=k("These are the learned character embeddings:"),vs=m(),bn(an.$$.fragment),ys=m(),J&&J.c(),xn=m(),na=l("p"),Ct=k("These are a sample of names generated by the LM:"),ws=m(),bn(sn.$$.fragment),Es=m(),z&&z.c(),aa=m(),sa=l("h2"),jt=k("Performance"),gs=m(),ta=l("p"),Ht=k("If I run 10000 steps of training on my CPU based on the code presented above, I get the following times:"),Is=m(),kn=l("table"),Ia=l("thead"),$n=l("tr"),Ta=l("th"),Mt=k("PyTorch"),zt=m(),Pa=l("th"),Nt=k("JAX"),Rt=m(),Aa=l("tbody"),Xn=l("tr"),$a=l("td"),Yt=k("5.6s"),Dt=m(),Xa=l("td"),Gt=k("158s"),Ts=m(),ea=l("p"),Bt=k(`But JAX has one more core functionality I didn’t mention, Just In Time (JIT) compilation.
When a function is decorated with the JIT decorator, all the operations in that function get compiled into a more efficient version that can then be run on any input of the same shape and type.`),Ps=m(),fn=l("p"),Ut=k("After we JIT the "),Ja=l("code"),Ot=k("train"),Kt=k(" function, we get:"),As=m(),hn=l("table"),La=l("thead"),tn=l("tr"),Wa=l("th"),qt=k("PyTorch"),Ft=m(),Ca=l("th"),St=k("JAX"),Vt=m(),ja=l("th"),Zt=k("JAX (after JIT)"),Qt=m(),Ha=l("tbody"),en=l("tr"),Ma=l("td"),xt=k("5.6s"),ne=m(),za=l("td"),ae=k("158s"),se=m(),Na=l("td"),te=k("5.9s"),$s=m(),oa=l("p"),ee=k("Nobody would normally train language models on MacBook CPUs, but this at least gives an idea on the importance of knowing how to use JIT when using JAX."),Xs=m(),pa=l("h2"),oe=k("Conclusion"),Js=m(),mn=l("p"),pe=k(`I believe this was a good introduction to JAX and to implementing language models.
A good next step would be to implement the more sophisticated LMs from later in the series, and using that as an opportunity to learn `),Jn=l("a"),le=k("Haiku"),ce=k("!"),this.h()},l(n){const e=wo("svelte-rlq60p",document.head);s=c(e,"LINK",{rel:!0,href:!0}),e.forEach(a),r=b(n),p=c(n,"H1",{});var Ra=u(p);i=f(Ra,ko),Ra.forEach(a),d=b(n),w=c(n,"P",{});var ma=u(w);_=c(ma,"A",{href:!0,rel:!0});var Ya=u(_);E=f(Ya,"JAX"),Ya.forEach(a),P=f(ma,` is a cool machine learning framework from Google.
Language models (LMs) are the family of models that include ChatGPT and GPT-4, which have taken the machine learning world by storm.`),ma.forEach(a),g=b(n),I=c(n,"P",{});var Da=u(I);D=f(Da,"What better way to learn about both than to implement a simple LM in JAX?"),Da.forEach(a),N=b(n),$=c(n,"H2",{});var Ga=u($);G=f(Ga,"Resources"),Ga.forEach(a),R=b(n),T=c(n,"P",{});var Ln=u(T);B=f(Ln,"I’ll heavily rely on Andrej Karpathy’s amazing course "),A=c(Ln,"A",{href:!0,rel:!0});var Ba=u(A);y=f(Ba,"Neural Networks: Zero to Hero"),Ba.forEach(a),q=f(Ln,` for this implementation.
The course starts from the very basics of neural networks and slowly builds up to implementing a GPT model.`),Ln.forEach(a),U=b(n),Y=c(n,"P",{});var Ua=u(Y);F=f(Ua,`If you are interested in learning about all of these things in detail, I highly recommend checking the course out.
This blog post is only concerned about porting the implementation to JAX, and won’t go into the theoretical background of what is being implemented.`),Ua.forEach(a),O=b(n),L=c(n,"P",{});var Ws=u(L);Ks=f(Ws,"As for JAX, I’ve found the "),gn=c(Ws,"A",{href:!0,rel:!0});var de=u(gn);qs=f(de,"official documentation"),de.forEach(a),Fs=f(Ws," adequate so far."),Ws.forEach(a),Oa=b(n),Wn=c(n,"H2",{});var _e=u(Wn);Ss=f(_e,"Model"),_e.forEach(a),Ka=b(n),on=c(n,"P",{});var Cs=u(on);Vs=f(Cs,"The model I’m interested in building is the Multi Layer Perceptron (MLP) model from "),In=c(Cs,"A",{href:!0,rel:!0});var ve=u(In);Zs=f(ve,"Building makemore Part 2: MLP"),ve.forEach(a),Qs=f(Cs,`.
I think this is a good starting point due to the simplicity of the model built in this chapter.`),Cs.forEach(a),qa=b(n),Cn=c(n,"P",{});var ye=u(Cn);xs=f(ye,"Following the steps in this video, I will be building a character-level LM that looks at the previous three characters to predict which character will come next."),ye.forEach(a),Fa=b(n),jn=c(n,"H2",{});var we=u(jn);nt=f(we,"Implementation"),we.forEach(a),Sa=b(n),Hn=c(n,"P",{});var Ee=u(Hn);at=f(Ee,"While displaying the relevant code blocks, I’ll also provide the PyTorch counterparts in a separate tab for easier comparison."),Ee.forEach(a),Va=b(n),Mn=c(n,"P",{});var ge=u(Mn);st=f(ge,"Let’s start by initializing the model parameters:"),ge.forEach(a),Za=b(n),dn(S.$$.fragment,n),Qa=b(n),W&&W.l(n),zn=b(n),pn=c(n,"P",{});var js=u(pn);tt=f(js,`You can notice they are very similar.
Other than method and parameter names, the only difference is how JAX handles random number generation.
You can read more about that in the corresponding section of `),Tn=c(js,"A",{href:!0,rel:!0});var Ie=u(Tn);et=f(Ie,"🔪 JAX - The Sharp Bits 🔪"),Ie.forEach(a),ot=f(js,"."),js.forEach(a),xa=b(n),Nn=c(n,"P",{});var Te=u(Nn);pt=f(Te,"Now let’s write the forward pass:"),Te.forEach(a),ns=b(n),dn(V.$$.fragment,n),as=b(n),C&&C.l(n),Rn=b(n),Yn=c(n,"P",{});var Pe=u(Yn);lt=f(Pe,"Again very similar."),Pe.forEach(a),ss=b(n),Dn=c(n,"P",{});var Ae=u(Dn);ct=f(Ae,"Now we need a loss function:"),Ae.forEach(a),ts=b(n),dn(Z.$$.fragment,n),es=b(n),j&&j.l(n),Gn=b(n),K=c(n,"P",{});var ba=u(K);it=f(ba,"Here literally the only change is replacing "),ya=c(ba,"CODE",{});var $e=u(ya);ut=f($e,"torch"),$e.forEach(a),rt=f(ba," with "),wa=c(ba,"CODE",{});var Xe=u(wa);kt=f(Xe,"jnp"),Xe.forEach(a),ft=f(ba,"."),ba.forEach(a),os=b(n),Bn=c(n,"P",{});var Je=u(Bn);ht=f(Je,"And now the training function, which is the first major difference between PyTorch and JAX:"),Je.forEach(a),ps=b(n),dn(Q.$$.fragment,n),ls=b(n),H&&H.l(n),Un=b(n),ln=c(n,"P",{});var Hs=u(ln);mt=f(Hs,"In PyTorch, we get a tensor from the loss function, which we can call "),Ea=c(Hs,"CODE",{});var Le=u(Ea);bt=f(Le,"backward"),Le.forEach(a),dt=f(Hs,` on to backpropagate the gradients to our parameters.
Then, we can loop through all our parameters and update them in-place.
We also need to remember to clear up the gradients for each parameter after every iteration, otherwise they would accumulate.`),Hs.forEach(a),cs=b(n),cn=c(n,"P",{});var Ms=u(cn);_t=f(Ms,"In JAX, we use "),ga=c(Ms,"CODE",{});var We=u(ga);vt=f(We,"grad"),We.forEach(a),yt=f(Ms,` on the loss function to obtain a new function that evaluates the gradients of that function with respect to the parameters we choose.
We then use that function to find the gradients at the current point in our parameter space, and use those gradients to update them.
Also notable: we need to return new arrays to replace the old ones, instead of updating them in-place as JAX follows a more functional paradigm than PyTorch.`),Ms.forEach(a),is=b(n),un=c(n,"P",{});var zs=u(un);wt=f(zs,"Even though I passed each parameter and received their gradients explicitly in this implementation, JAX also has ways to pass all parameters and receive all gradients together using "),Pn=c(zs,"A",{href:!0,rel:!0});var Ce=u(Pn);Et=f(Ce,"pytrees"),Ce.forEach(a),gt=f(zs,"."),zs.forEach(a),us=b(n),On=c(n,"P",{});var je=u(On);It=f(je,"Finally, the training loop:"),je.forEach(a),rs=b(n),dn(x.$$.fragment,n),ks=b(n),M&&M.l(n),Kn=b(n),qn=c(n,"P",{});var He=u(qn);Tt=f(He,"Again we see only minimal differences due to how the two libraries handle random number generation differently."),He.forEach(a),fs=b(n),Fn=c(n,"H2",{});var Me=u(Fn);Pt=f(Me,"Data"),Me.forEach(a),hs=b(n),rn=c(n,"P",{});var Ns=u(rn);At=f(Ns,"I’ll use the same "),An=c(Ns,"A",{href:!0,rel:!0});var ze=u(An);$t=f(ze,"dataset of 32K English names"),ze.forEach(a),Xt=f(Ns," as Andrej and split it into train / dev / test sets in the same way."),Ns.forEach(a),ms=b(n),Sn=c(n,"H2",{});var Ne=u(Sn);Jt=f(Ne,"Training & Evaluation"),Ne.forEach(a),bs=b(n),Vn=c(n,"P",{});var Re=u(Vn);Lt=f(Re,"Here are the training and dev losses during training:"),Re.forEach(a),ds=b(n),dn(nn.$$.fragment,n),_s=b(n),X&&X.l(n),Zn=b(n),Qn=c(n,"P",{});var Ye=u(Qn);Wt=f(Ye,"These are the learned character embeddings:"),Ye.forEach(a),vs=b(n),dn(an.$$.fragment,n),ys=b(n),J&&J.l(n),xn=b(n),na=c(n,"P",{});var De=u(na);Ct=f(De,"These are a sample of names generated by the LM:"),De.forEach(a),ws=b(n),dn(sn.$$.fragment,n),Es=b(n),z&&z.l(n),aa=b(n),sa=c(n,"H2",{});var Ge=u(sa);jt=f(Ge,"Performance"),Ge.forEach(a),gs=b(n),ta=c(n,"P",{});var Be=u(ta);Ht=f(Be,"If I run 10000 steps of training on my CPU based on the code presented above, I get the following times:"),Be.forEach(a),Is=b(n),kn=c(n,"TABLE",{});var Rs=u(kn);Ia=c(Rs,"THEAD",{});var Ue=u(Ia);$n=c(Ue,"TR",{});var Ys=u($n);Ta=c(Ys,"TH",{});var Oe=u(Ta);Mt=f(Oe,"PyTorch"),Oe.forEach(a),zt=b(Ys),Pa=c(Ys,"TH",{});var Ke=u(Pa);Nt=f(Ke,"JAX"),Ke.forEach(a),Ys.forEach(a),Ue.forEach(a),Rt=b(Rs),Aa=c(Rs,"TBODY",{});var qe=u(Aa);Xn=c(qe,"TR",{});var Ds=u(Xn);$a=c(Ds,"TD",{});var Fe=u($a);Yt=f(Fe,"5.6s"),Fe.forEach(a),Dt=b(Ds),Xa=c(Ds,"TD",{});var Se=u(Xa);Gt=f(Se,"158s"),Se.forEach(a),Ds.forEach(a),qe.forEach(a),Rs.forEach(a),Ts=b(n),ea=c(n,"P",{});var Ve=u(ea);Bt=f(Ve,`But JAX has one more core functionality I didn’t mention, Just In Time (JIT) compilation.
When a function is decorated with the JIT decorator, all the operations in that function get compiled into a more efficient version that can then be run on any input of the same shape and type.`),Ve.forEach(a),Ps=b(n),fn=c(n,"P",{});var Gs=u(fn);Ut=f(Gs,"After we JIT the "),Ja=c(Gs,"CODE",{});var Ze=u(Ja);Ot=f(Ze,"train"),Ze.forEach(a),Kt=f(Gs," function, we get:"),Gs.forEach(a),As=b(n),hn=c(n,"TABLE",{});var Bs=u(hn);La=c(Bs,"THEAD",{});var Qe=u(La);tn=c(Qe,"TR",{});var da=u(tn);Wa=c(da,"TH",{});var xe=u(Wa);qt=f(xe,"PyTorch"),xe.forEach(a),Ft=b(da),Ca=c(da,"TH",{});var no=u(Ca);St=f(no,"JAX"),no.forEach(a),Vt=b(da),ja=c(da,"TH",{});var ao=u(ja);Zt=f(ao,"JAX (after JIT)"),ao.forEach(a),da.forEach(a),Qe.forEach(a),Qt=b(Bs),Ha=c(Bs,"TBODY",{});var so=u(Ha);en=c(so,"TR",{});var _a=u(en);Ma=c(_a,"TD",{});var to=u(Ma);xt=f(to,"5.6s"),to.forEach(a),ne=b(_a),za=c(_a,"TD",{});var eo=u(za);ae=f(eo,"158s"),eo.forEach(a),se=b(_a),Na=c(_a,"TD",{});var oo=u(Na);te=f(oo,"5.9s"),oo.forEach(a),_a.forEach(a),so.forEach(a),Bs.forEach(a),$s=b(n),oa=c(n,"P",{});var po=u(oa);ee=f(po,"Nobody would normally train language models on MacBook CPUs, but this at least gives an idea on the importance of knowing how to use JIT when using JAX."),po.forEach(a),Xs=b(n),pa=c(n,"H2",{});var lo=u(pa);oe=f(lo,"Conclusion"),lo.forEach(a),Js=b(n),mn=c(n,"P",{});var Us=u(mn);pe=f(Us,`I believe this was a good introduction to JAX and to implementing language models.
A good next step would be to implement the more sophisticated LMs from later in the series, and using that as an opportunity to learn `),Jn=c(Us,"A",{href:!0,rel:!0});var co=u(Jn);le=f(co,"Haiku"),co.forEach(a),ce=f(Us,"!"),Us.forEach(a),this.h()},h(){document.title="Doga Tekin on Learning JAX",v(s,"rel","stylesheet"),v(s,"href","https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/themes/prism-tomorrow.min.css"),v(_,"href","https://github.com/google/jax"),v(_,"rel","nofollow"),v(A,"href","https://karpathy.ai/zero-to-hero.html"),v(A,"rel","nofollow"),v(gn,"href","https://jax.readthedocs.io/en/latest/index.html"),v(gn,"rel","nofollow"),v(In,"href","https://www.youtube.com/watch?v=TCH_1BHY58I"),v(In,"rel","nofollow"),v(Tn,"href","https://jax.readthedocs.io/en/latest/notebooks/Common_Gotchas_in_JAX.html#random-numbers"),v(Tn,"rel","nofollow"),v(Pn,"href","https://jax.readthedocs.io/en/latest/jax-101/05.1-pytrees.html"),v(Pn,"rel","nofollow"),v(An,"href","https://github.com/karpathy/makemore/blob/master/names.txt"),v(An,"rel","nofollow"),v(Jn,"href","https://github.com/deepmind/dm-haiku"),v(Jn,"rel","nofollow")},m(n,e){t(document.head,s),o(n,r,e),o(n,p,e),t(p,i),o(n,d,e),o(n,w,e),t(w,_),t(_,E),t(w,P),o(n,g,e),o(n,I,e),t(I,D),o(n,N,e),o(n,$,e),t($,G),o(n,R,e),o(n,T,e),t(T,B),t(T,A),t(A,y),t(T,q),o(n,U,e),o(n,Y,e),t(Y,F),o(n,O,e),o(n,L,e),t(L,Ks),t(L,gn),t(gn,qs),t(L,Fs),o(n,Oa,e),o(n,Wn,e),t(Wn,Ss),o(n,Ka,e),o(n,on,e),t(on,Vs),t(on,In),t(In,Zs),t(on,Qs),o(n,qa,e),o(n,Cn,e),t(Cn,xs),o(n,Fa,e),o(n,jn,e),t(jn,nt),o(n,Sa,e),o(n,Hn,e),t(Hn,at),o(n,Va,e),o(n,Mn,e),t(Mn,st),o(n,Za,e),_n(S,n,e),o(n,Qa,e),W&&W.m(n,e),o(n,zn,e),o(n,pn,e),t(pn,tt),t(pn,Tn),t(Tn,et),t(pn,ot),o(n,xa,e),o(n,Nn,e),t(Nn,pt),o(n,ns,e),_n(V,n,e),o(n,as,e),C&&C.m(n,e),o(n,Rn,e),o(n,Yn,e),t(Yn,lt),o(n,ss,e),o(n,Dn,e),t(Dn,ct),o(n,ts,e),_n(Z,n,e),o(n,es,e),j&&j.m(n,e),o(n,Gn,e),o(n,K,e),t(K,it),t(K,ya),t(ya,ut),t(K,rt),t(K,wa),t(wa,kt),t(K,ft),o(n,os,e),o(n,Bn,e),t(Bn,ht),o(n,ps,e),_n(Q,n,e),o(n,ls,e),H&&H.m(n,e),o(n,Un,e),o(n,ln,e),t(ln,mt),t(ln,Ea),t(Ea,bt),t(ln,dt),o(n,cs,e),o(n,cn,e),t(cn,_t),t(cn,ga),t(ga,vt),t(cn,yt),o(n,is,e),o(n,un,e),t(un,wt),t(un,Pn),t(Pn,Et),t(un,gt),o(n,us,e),o(n,On,e),t(On,It),o(n,rs,e),_n(x,n,e),o(n,ks,e),M&&M.m(n,e),o(n,Kn,e),o(n,qn,e),t(qn,Tt),o(n,fs,e),o(n,Fn,e),t(Fn,Pt),o(n,hs,e),o(n,rn,e),t(rn,At),t(rn,An),t(An,$t),t(rn,Xt),o(n,ms,e),o(n,Sn,e),t(Sn,Jt),o(n,bs,e),o(n,Vn,e),t(Vn,Lt),o(n,ds,e),_n(nn,n,e),o(n,_s,e),X&&X.m(n,e),o(n,Zn,e),o(n,Qn,e),t(Qn,Wt),o(n,vs,e),_n(an,n,e),o(n,ys,e),J&&J.m(n,e),o(n,xn,e),o(n,na,e),t(na,Ct),o(n,ws,e),_n(sn,n,e),o(n,Es,e),z&&z.m(n,e),o(n,aa,e),o(n,sa,e),t(sa,jt),o(n,gs,e),o(n,ta,e),t(ta,Ht),o(n,Is,e),o(n,kn,e),t(kn,Ia),t(Ia,$n),t($n,Ta),t(Ta,Mt),t($n,zt),t($n,Pa),t(Pa,Nt),t(kn,Rt),t(kn,Aa),t(Aa,Xn),t(Xn,$a),t($a,Yt),t(Xn,Dt),t(Xn,Xa),t(Xa,Gt),o(n,Ts,e),o(n,ea,e),t(ea,Bt),o(n,Ps,e),o(n,fn,e),t(fn,Ut),t(fn,Ja),t(Ja,Ot),t(fn,Kt),o(n,As,e),o(n,hn,e),t(hn,La),t(La,tn),t(tn,Wa),t(Wa,qt),t(tn,Ft),t(tn,Ca),t(Ca,St),t(tn,Vt),t(tn,ja),t(ja,Zt),t(hn,Qt),t(hn,Ha),t(Ha,en),t(en,Ma),t(Ma,xt),t(en,ne),t(en,za),t(za,ae),t(en,se),t(en,Na),t(Na,te),o(n,$s,e),o(n,oa,e),t(oa,ee),o(n,Xs,e),o(n,pa,e),t(pa,oe),o(n,Js,e),o(n,mn,e),t(mn,pe),t(mn,Jn),t(Jn,le),t(mn,ce),Ls=!0},p(n,[e]){const Ra={};e&1&&(Ra.activeItem=n[0]),S.$set(Ra),la!==(la=ie(n))&&(W&&W.d(1),W=la&&la(n),W&&(W.c(),W.m(zn.parentNode,zn)));const ma={};e&1&&(ma.activeItem=n[0]),V.$set(ma),ca!==(ca=ue(n))&&(C&&C.d(1),C=ca&&ca(n),C&&(C.c(),C.m(Rn.parentNode,Rn)));const Ya={};e&1&&(Ya.activeItem=n[0]),Z.$set(Ya),ia!==(ia=re(n))&&(j&&j.d(1),j=ia&&ia(n),j&&(j.c(),j.m(Gn.parentNode,Gn)));const Da={};e&1&&(Da.activeItem=n[0]),Q.$set(Da),ua!==(ua=ke(n))&&(H&&H.d(1),H=ua&&ua(n),H&&(H.c(),H.m(Un.parentNode,Un)));const Ga={};e&1&&(Ga.activeItem=n[0]),x.$set(Ga),ra!==(ra=fe(n))&&(M&&M.d(1),M=ra&&ra(n),M&&(M.c(),M.m(Kn.parentNode,Kn)));const Ln={};e&1&&(Ln.activeItem=n[0]),nn.$set(Ln),ka===(ka=he(n))&&X?X.p(n,e):(X&&X.d(1),X=ka&&ka(n),X&&(X.c(),X.m(Zn.parentNode,Zn)));const Ba={};e&1&&(Ba.activeItem=n[0]),an.$set(Ba),fa===(fa=me(n))&&J?J.p(n,e):(J&&J.d(1),J=fa&&fa(n),J&&(J.c(),J.m(xn.parentNode,xn)));const Ua={};e&1&&(Ua.activeItem=n[0]),sn.$set(Ua),ha!==(ha=be(n))&&(z&&z.d(1),z=ha&&ha(n),z&&(z.c(),z.m(aa.parentNode,aa)))},i(n){Ls||(vn(S.$$.fragment,n),vn(V.$$.fragment,n),vn(Z.$$.fragment,n),vn(Q.$$.fragment,n),vn(x.$$.fragment,n),vn(nn.$$.fragment,n),vn(an.$$.fragment,n),vn(sn.$$.fragment,n),Ls=!0)},o(n){yn(S.$$.fragment,n),yn(V.$$.fragment,n),yn(Z.$$.fragment,n),yn(Q.$$.fragment,n),yn(x.$$.fragment,n),yn(nn.$$.fragment,n),yn(an.$$.fragment,n),yn(sn.$$.fragment,n),Ls=!1},d(n){a(s),n&&a(r),n&&a(p),n&&a(d),n&&a(w),n&&a(g),n&&a(I),n&&a(N),n&&a($),n&&a(R),n&&a(T),n&&a(U),n&&a(Y),n&&a(O),n&&a(L),n&&a(Oa),n&&a(Wn),n&&a(Ka),n&&a(on),n&&a(qa),n&&a(Cn),n&&a(Fa),n&&a(jn),n&&a(Sa),n&&a(Hn),n&&a(Va),n&&a(Mn),n&&a(Za),wn(S,n),n&&a(Qa),W&&W.d(n),n&&a(zn),n&&a(pn),n&&a(xa),n&&a(Nn),n&&a(ns),wn(V,n),n&&a(as),C&&C.d(n),n&&a(Rn),n&&a(Yn),n&&a(ss),n&&a(Dn),n&&a(ts),wn(Z,n),n&&a(es),j&&j.d(n),n&&a(Gn),n&&a(K),n&&a(os),n&&a(Bn),n&&a(ps),wn(Q,n),n&&a(ls),H&&H.d(n),n&&a(Un),n&&a(ln),n&&a(cs),n&&a(cn),n&&a(is),n&&a(un),n&&a(us),n&&a(On),n&&a(rs),wn(x,n),n&&a(ks),M&&M.d(n),n&&a(Kn),n&&a(qn),n&&a(fs),n&&a(Fn),n&&a(hs),n&&a(rn),n&&a(ms),n&&a(Sn),n&&a(bs),n&&a(Vn),n&&a(ds),wn(nn,n),n&&a(_s),X&&X.d(n),n&&a(Zn),n&&a(Qn),n&&a(vs),wn(an,n),n&&a(ys),J&&J.d(n),n&&a(xn),n&&a(na),n&&a(ws),wn(sn,n),n&&a(Es),z&&z.d(n),n&&a(aa),n&&a(sa),n&&a(gs),n&&a(ta),n&&a(Is),n&&a(kn),n&&a(Ts),n&&a(ea),n&&a(Ps),n&&a(fn),n&&a(As),n&&a(hn),n&&a($s),n&&a(oa),n&&a(Xs),n&&a(pa),n&&a(Js),n&&a(mn)}}}const Oo={title:"Learning JAX by Implementing a Simple Language Model",date:"2023-04-25"},{title:ko,date:Fo}=Oo;function Ko(h,s,r){let p=["Torch","JAX"],i="JAX";return[i,p,w=>{r(0,i=w.detail)}]}class So extends fo{constructor(s){super(),ho(this,s,Ko,Uo,mo,{})}}export{So as default,Oo as metadata};
